#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define LCD_TO_BMP 2
#define TST_PRINT  1
/*
0: convert BMP to LCD byte stream
1: convert original LCD byte stream to BMP
2: convert modified LCD byte stream to BMP
*/

#define SUCCESS_EC 0
#define UNSUCCESS_EC -1

typedef unsigned short uint16_t;
typedef unsigned int uint32_t;
typedef int int32_t;

typedef struct  {
  unsigned char magic[2];
} bmpfile_magic__t;

typedef struct  {
  uint32_t filesz;
  uint16_t creator1;
  uint16_t creator2;
  uint32_t bmp_offset;
} bmpfile_header__t;

typedef struct {
  uint32_t header_sz;
  int32_t width;
  int32_t height;
  uint16_t nplanes;
  uint16_t bitspp;
  uint32_t compress_type;
  uint32_t bmp_bytesz;
  int32_t hres;
  int32_t vres;
  uint32_t ncolors;
  uint32_t nimpcolors;
} bitmap_info_header__t;

typedef enum {
  BI_RGB = 0,
  BI_RLE8,
  BI_RLE4,
  BI_BITFIELDS, //Also Huffman 1D compression for BITMAPCOREHEADER2
  BI_JPEG,      //Also RLE-24 compression for BITMAPCOREHEADER2
  BI_PNG,
} bmp_compression_method_t;


unsigned char logo[] =	  //simbo
{
/*------------------------------------------------------------------------------
;  源文件 / 文字 : MYSTORY
;  宽×高（像素）: 128×64
;  字模格式/大小 : 单色点阵液晶字模，纵向取模，字节正序/1024字节
;  数据转换日期  : 2012-4-3 22:48:16
------------------------------------------------------------------------------*/
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFC,0xFC,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFF,0xFF,0xFD,0xFC,0xFC,0xFC,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFC,0xFC,0xFC,0xFC,0xFD,0xFF,0xFF,0xFF,0xFE,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0xFD,0xFC,0xFC,0xFC,0xFC,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFC,0xFC,0xFD,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0xFF,0xF8,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x7F,0x1F,0x07,0x01,0x00,0xC0,0xF0,0xF0,0xC0,
0x00,0x01,0x07,0x1F,0x7F,0xFF,0xFF,0x83,0x01,0x00,0x00,0x78,0xF8,0xFC,0xFC,0x7E,
0x0E,0x0F,0x0F,0x8F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,
0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xE0,0x80,0x00,0x00,0x1F,0x7F,0xFF,
0xFF,0xFF,0x7F,0x1F,0x00,0x00,0x80,0xE0,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0xFF,
0xFF,0xFF,0xFF,0x7E,0x3C,0x00,0x00,0x00,0x81,0xFF,0xFF,0xFF,0x7F,0x1F,0x07,0x01,
0x00,0xC0,0xF0,0xF0,0xC0,0x00,0x01,0x07,0x1F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x1F,0x00,0x00,0xE0,0x00,0x00,0x1F,
0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x00,0x00,0x00,0x00,
0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF1,0xF0,0xF0,0xF0,0x7E,0x7F,0x3F,0x3F,0x1F,
0x0E,0x00,0x00,0x80,0xE0,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,
0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x07,0x00,0x00,0x00,0xFC,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFC,0x00,0x00,0x00,0x07,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x3F,
0x3F,0x1F,0x07,0x01,0x00,0x20,0x78,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x7F,0x00,0x00,0x00,0x00,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0x1F,0x1F,0x1F,0x1F,0xFF,0xFF,0x1F,0x1F,0x1F,0xFF,0xFF,
0x1F,0x1F,0x1F,0x1F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x1F,0x1F,0x1F,0x1F,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x3F,0x3F,0x1F,0x1F,0x9F,0x9F,0x9F,
0x1F,0x3F,0x3F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x1F,0x1F,
0x1F,0x1F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x3F,0x1F,0x1F,0x9F,
0x9F,0x9F,0x1F,0x1F,0x3F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0x1F,0x1F,0x1F,0x1F,0xFF,
0xFF,0xFF,0xFF,0xFF,0x7F,0x1F,0x1F,0x1F,0x1F,0xDF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0x1F,0x1F,0x1F,0x1F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF
};
#if 0
unsigned char modified_logo[] =
{
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,
0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFC,0xFC,
0xFC,0xFC,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,
0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,
0xFC,0xFC,0xFC,0xFC,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xFE,
0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xFF,0xFF,0xE0,
0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x7F,0x1F,0x07,0x01,0x00,0xC0,0xF8,0xFE,0xFC,
0xF0,0xC0,0x00,0x03,0x0F,0x3F,0xFF,0xFF,0xFF,0x81,0x00,0x00,0x00,0x3C,0x7E,0x7F,
0x7F,0x3F,0x0F,0x07,0x07,0x87,0xE7,0xFF,0xFF,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x00,
0x00,0x00,0x00,0x7F,0x7F,0x7F,0x7F,0x7F,0xFF,0xFF,0xF0,0xC0,0x00,0x00,0x07,0x1F,
0x3F,0x7F,0x7F,0x3F,0x1F,0x00,0x00,0x80,0xC0,0xFC,0xFF,0x00,0x00,0x00,0x00,0x00,
0x7F,0x7F,0x7F,0x7F,0x3F,0x1F,0x00,0x00,0x00,0x80,0xFF,0xFF,0x7F,0x1F,0x07,0x01,
0x00,0xC0,0xF8,0xFE,0xFC,0xF0,0xC0,0x00,0x03,0x0F,0x3F,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x07,0x00,0x00,0x80,0x00,0x00,
0x00,0x0F,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x1F,0x00,0x00,0x00,
0x00,0x3F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFC,0x7C,0x3F,0x3F,0x1F,0x1F,
0x0F,0x0F,0x87,0x80,0xC0,0xE0,0xF0,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,
0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0xFC,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x03,0xFF,0x00,0x00,0x00,0x00,0x00,
0x8F,0x8F,0x87,0x81,0x00,0x00,0x10,0x1C,0x3F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x7F,0x1F,0x00,0x00,0x00,0x00,0x3F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x07,0x07,0x07,0x07,0xFF,0x3F,0x07,0x07,0x07,0x07,
0xFF,0xFF,0x07,0x07,0x07,0x07,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x07,0x07,0x07,
0x07,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x1F,0x0F,0x07,0x07,0xC7,0xE3,0xE3,
0xE3,0xE3,0xC7,0x07,0x07,0x0F,0x1F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x07,
0x07,0x07,0x07,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x3F,0x0F,0x07,0x07,0x87,
0xC3,0xE3,0xE3,0xC3,0x87,0x07,0x0F,0x1F,0x3F,0xFF,0xFF,0x07,0x07,0x07,0x07,0x07,
0xFF,0xFF,0xFF,0xFF,0x7F,0x1F,0x07,0x07,0x07,0xC7,0xF7,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0x07,0x07,0x07,0x07,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xDF,0x9F,0x8F,0x87,0xC3,0xC3,0xE7,0xC0,0xC0,0xC0,0xCF,0xCE,0xCE,
0xCE,0xCE,0xC0,0xC0,0xC0,0xDF,0xF7,0xF0,0xF0,0xF0,0xFF,0x00,0x00,0x00,0x00,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x80,0x80,0x80,0xB2,0xB2,0xB2,0xB2,0xB2,0xB2,0xB2,
0xB2,0xB2,0xB2,0xB2,0xB2,0xB2,0xB2,0x80,0x80,0x80,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xF1,0xF1,0xF3,0xF3,0xF3,0xF3,0xF3,0xF0,0xC0,0x00,0x00,0x03,
0x73,0xF3,0xF3,0xF3,0xF3,0xF3,0xF3,0xF1,0xF1,0xF1,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xE0,0xE0,0xE0,0xE0,0xE7,0xE7,0xE7,0xE7,0xE7,0xE7,0xE7,0x67,0x07,0x07,0x07,0x07,
0xE7,0xE7,0xE7,0xE7,0xE7,0xE7,0xE7,0xE7,0xE0,0xE0,0xE0,0xEF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0x1F,0x1F,0x0F,0x87,0xC6,0xEF,0xFF,0x00,0x00,0x00,0xFF,0x00,0x00,
0x00,0x01,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0xFF,
0xFF,0xCF,0xCF,0xCF,0xCF,0xCF,0x48,0x48,0x48,0x4B,0x4B,0x4B,0x4B,0x4B,0x48,0x48,
0x48,0x48,0x4B,0x4B,0x4B,0x4B,0x4B,0x48,0x48,0x48,0xCF,0xCF,0xCF,0xCF,0xFF,0xFF,
0xFF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCE,0xC8,0x80,0x00,0x03,0x0F,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xFF,0xFF,0xFF,
0x3E,0x3E,0x3C,0x3C,0xFC,0xF8,0x38,0x31,0x31,0x23,0x02,0x00,0x00,0x00,0x18,0x3C,
0x3F,0x3E,0x3C,0x3C,0x38,0x30,0x21,0xE3,0x73,0x7B,0x7F,0x7F,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFE,0xF8,0xE0,0x80,0x01,0x0F,0x3F,0x1F,0x1E,0x18,0x80,0x00,0x01,
0x03,0xF0,0x30,0x38,0x3C,0xBF,0xFF,0x07,0x07,0x07,0xFF,0x00,0x00,0x00,0x00,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0x0C,0x0C,0x0C,0x6C,0x6C,0x6C,0x6C,0x6C,0x00,0x00,
0x00,0x00,0x6C,0x6C,0x6C,0x6C,0x6C,0x0C,0x0C,0x0C,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x3F,0x38,0x38,0x38,0x3C,0x3C,0x3C,0x3E,
0x3C,0x38,0x30,0x01,0x03,0x07,0x0F,0x1F,0x3F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xF7,0x73,0x63,0x63,0x62,0xC6,0xC6,0x8C,0x88,0x18,0x31,0x21,0x63,0x47,0x07,0x00,
0x00,0x00,0x3F,0x0F,0x03,0x01,0xC0,0xF0,0xF8,0xFC,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0x3F,0x3F,0x1F,0x1F,0x7F,0xFF,0xFF,0xDF,0x8F,0x0F,0x0F,0x3F,0x7F,0xFF,
0xFF,0xFF,0x7F,0x1F,0x1F,0x1F,0xBF,0xFF,0xBF,0x8F,0x8F,0x0F,0x1F,0x1F,0x3F,0xFF,
0xFF,0xFF,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x1F,0x1F,
0x1F,0x1F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0x9F,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x7F,0x7F,0x3F,
0x3F,0x1F,0x1F,0x1F,0x8F,0x8F,0xBF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x9F,0x8F,0x0F,0x1F,0x1F,0x3F,0x7F,0x7F,0xFF,0xFF,0x9F,0x8F,0x8F,0x8F,0x0F,0x1F,
0x1F,0x3F,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x3F,0x3F,0x3F,0x7F,0x7F,0xFF,0xFF,0xFF
};
#endif

unsigned char modified_logo[] = 
{
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xFF,0xFF,0xFF,0xFF,0xFE,
0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xFF,0xFB,0xF8,0xF8,0xF8,0xF8,0xF8,0xFC,0xFF,
0xFF,0xFF,0xFF,0xFE,0xF8,0xF8,0xF8,0xF8,0xF8,0xFB,0xFE,0xFC,0xF8,0xF8,0xF8,0xF8,
0xF8,0xF8,0xF8,0xF8,0xF8,0xFC,0xFE,0xFF,0xFF,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,
0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xFF,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,
0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xFC,0xFC,0xFF,0xFF,0xFF,0xFE,0xFC,0xF8,0xF8,
0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xF8,0xFC,0xFE,0xFB,0xF9,0xF8,0xF8,0xF8,0xF8,
0xFC,0xFE,0xFF,0xFF,0xFF,0xFE,0xFC,0xF8,0xF8,0xF8,0xF8,0xF9,0xFB,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x0F,0x01,0x00,0x80,0xF0,0xFC,0xC0,0x00,
0x00,0x07,0x1F,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x7F,0x1F,0x0F,0x03,0x00,0x00,
0xC0,0xC0,0x00,0x00,0x03,0x0F,0x1F,0x7F,0xFF,0x1F,0x07,0x07,0x03,0x03,0x41,0xC1,
0xE1,0xE0,0x60,0x20,0x30,0x30,0x38,0x3C,0xFF,0x7F,0x7F,0x7F,0x7F,0x7F,0x00,0x00,
0x00,0x00,0x00,0x00,0x7F,0x7F,0x7F,0x7F,0x7F,0xFF,0x00,0x00,0x00,0x00,0x00,0x61,
0xF1,0xF0,0xF0,0x60,0x00,0x00,0x02,0x03,0x07,0x3F,0xE0,0x00,0x00,0x00,0x00,0x0E,
0x3F,0x7F,0x7F,0x7F,0x7F,0x3F,0x1F,0x00,0x00,0x00,0x00,0xC0,0x7F,0x3F,0x0F,0x07,
0x01,0x00,0x80,0xC0,0x80,0x00,0x03,0x07,0x1F,0x3F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0x03,0x03,0x03,0x03,0x03,0xFF,0xFF,0x1F,0x03,0x03,0x03,0x03,0x07,
0x7F,0xFF,0xFF,0x03,0x03,0x03,0x03,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x03,0x03,
0x03,0x03,0x03,0x03,0xFF,0xFF,0xFF,0xFF,0xFF,0x1F,0x07,0x07,0x03,0x03,0xC3,0xE3,
0xE3,0xE3,0xC3,0x03,0x03,0x07,0x07,0x1F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x03,0x03,
0x03,0x03,0x03,0x03,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x03,0x03,0x03,0x03,0x03,0xFF,
0xFF,0xFF,0x7F,0x1F,0x07,0x03,0x03,0x03,0x83,0xE3,0x7B,0x1F,0x0F,0x07,0x03,0x03,
0x83,0xC3,0xC3,0xE3,0xC3,0xC3,0x03,0x03,0x07,0x0F,0x1F,0x7F,0xFF,0xFF,0xFF,0xFF,
0xFF,0x03,0x03,0x03,0x03,0x03,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFC,
0xFC,0xFD,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFD,0xFD,0xFD,0xFD,0xFD,0xFD,0xFC,0xFC,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xCF,0xCE,0x6C,0x01,0x01,0x80,0x80,0x01,0x01,0x00,0x00,0x00,
0x00,0xFF,0xFF,0xFF,0xFF,0xEF,0x20,0x20,0x24,0x24,0x20,0x20,0x24,0x24,0x20,0x20,
0xEF,0xFF,0xFF,0xFF,0xEF,0x6F,0x6E,0x68,0x41,0x03,0x2B,0x6B,0x6A,0x68,0x69,0x69,
0xEF,0xEF,0xFF,0xFF,0x1B,0x1A,0x1A,0x50,0x54,0x40,0x42,0x50,0x58,0x58,0x40,0x27,
0x37,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xDF,0x1F,0x3F,0xDF,0x1F,0x3F,0x7F,0x3F,0x3F,0xBF,0xDF,0x1F,
0x1F,0xFF,0xFF,0xFF,0xDF,0x9F,0x9F,0x9F,0x9F,0x9F,0x1F,0x1F,0x9F,0x9F,0x9F,0x9F,
0x9F,0xDF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x7F,0x3F,0x3F,0x3F,0x1F,0x9F,0xDF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xDF,0x5F,0x1F,0xBF,0x3F,0x5F,0x5F,0x1F,0x1F,0xFF,0x7F,0x3F,
0xBF,0xBF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF
};

unsigned char get_bit__r(unsigned char c, int bit_idx)
{
	return ((c>>bit_idx)&1);
}

void set_bit__r( unsigned char *c, int bit_idx)
{
	*c = *c | (1<<bit_idx);
}

void lcd2array_mapping__r(int lcd_byte, int lcd_bit, int lcd_width, int *col, int *row)
{
	*col = lcd_byte%lcd_width;
	*row = ((int)(lcd_byte/lcd_width))*8+(7-lcd_bit);
}

void array2lcd_mapping__r(int row, int col, int lcd_width, int *lcd_byte, int *lcd_bit)
{
	*lcd_bit = 7 - (row%8);
	*lcd_byte = ((int)(row/8))*lcd_width+col;
}

void bmp2array_mapping__r(int bmp_byte, int bmp_bit, int bmp_height, int bmp_width, int *col, int *row)
{
	*row = bmp_height-1-(int)(bmp_byte*8/bmp_width);
	*col = (bmp_byte*8+7-bmp_bit)%bmp_width;
}

void array2bmp_mapping__r(int col, int row, int bmp_height, int bmp_width, int *bmp_byte, int *bmp_bit)
{
	int point_idx;
	
	point_idx = (bmp_height-1-row)*bmp_width + col;
	*bmp_byte = (int)(point_idx/8);
	*bmp_bit = 7 - (point_idx%8);
	
}

void print_guide__r()
{
  printf("\n");
  printf("/***************************************************************/\n");
  printf("/* B2LConverter:                                               */\n");
  printf("/* --used to convert BMP picture to LCD display byte stream;   */\n");
  printf("/* --used to convert LCD display byte stream to BMP picture;   */\n");
  printf("/*-------------------------------------------------------------*/\n");
  printf("/* Usage:                                                      */\n");
  printf("/*  BMP => LCD: B2LConverter b2l [BMP file name]               */\n");
  printf("/*          eg: B2LConverter b2l test.bmp                      */\n");
  printf("/*  LCD => BMP: B2LConverter l2b <height> <width> [TXT file]   */\n");
  printf("/*          eg: B2LConverter l2b 64 128 test.txt               */\n");
  printf("/***************************************************************/\n");
  printf("\n");
}

int read_bmp_file_to_buffer__r( const char *p_file_name, 
                                char **p_data_buff, 
                                uint32_t *p_data_size,
                                uint32_t *p_width,
                                uint32_t *p_height )
{
  int ret_val = SUCCESS_EC;
  long file_size;
  FILE *ptr_file = NULL;
  char *bmp_file_buff = NULL;
  char *bmp_data_buff = NULL;
  bmpfile_header__t *ptr_bmpfile_hd = NULL;
  bitmap_info_header__t *ptr_bmp_info_hd = NULL;
  
#if TST_PRINT
  printf("==> read_bmp_file_to_buffer__r %s\n", p_file_name);
#endif
  
  ptr_file = fopen(p_file_name, "rb");
  if(NULL==ptr_file)
  {
    printf("/*** Fail to open file %s! ***/\n", p_file_name);
    return UNSUCCESS_EC;
  }
  
  fseek (ptr_file , 0 , SEEK_END);
  file_size = ftell (ptr_file);
  rewind (ptr_file);
  
  bmp_file_buff = (char *)malloc(file_size);
  if(bmp_file_buff == NULL)
  {
    printf("/*** Fail to allocate memery buffer for BMP file! ***/\n");
    fclose(ptr_file);
    return UNSUCCESS_EC;
  }

  fread(bmp_file_buff, 1, file_size, ptr_file);
  fclose(ptr_file);
	
  ptr_bmpfile_hd = (bmpfile_header__t *)(bmp_file_buff + sizeof(bmpfile_magic__t));
  ptr_bmp_info_hd = (bitmap_info_header__t *)( bmp_file_buff + 
                                               sizeof(bmpfile_magic__t) +
                                               sizeof(bmpfile_header__t) );
  *p_data_size = ptr_bmp_info_hd->bmp_bytesz;
  *p_width = ptr_bmp_info_hd->width;
  *p_height = ptr_bmp_info_hd->height;

#if TST_PRINT
  printf("p_data_size: %d\n", *p_data_size);
  printf("p_width:     %d\n", *p_width);
  printf("p_height:    %d\n", *p_height);
#endif
  
  if( (*p_width%8 != 0) || (*p_height%8 != 0) )
  {
    printf("/*** The size of BMP file is not (8M)X(8N)! ***/\n");
    free(bmp_file_buff);
    return UNSUCCESS_EC;
  }
  
  *p_data_buff = (char *)malloc(*p_data_size);
  if( *p_data_buff == NULL )
  {
    printf("/*** Fail to allocate memery buffer for BMP data! ***/\n");
    free(bmp_file_buff);
    return UNSUCCESS_EC;
  }
  
  memcpy( *p_data_buff, 
          (bmp_file_buff+ptr_bmpfile_hd->bmp_offset ),
          *p_data_size );
  free(bmp_file_buff);
    
  return SUCCESS_EC;
}

void map_bmp_to_bit_array__r( char *p_bmp_data_buff,
                              char *p_bit_array,
                              uint32_t p_bmp_data_size,
                              uint32_t p_bmp_width,
                              uint32_t p_bmp_height )
{
  int i, j, col, row;
  
#if TST_PRINT
  printf("==> map_bmp_to_bit_array__r\n");
#endif  
  
  for(i=0; i<p_bmp_data_size; i++)
  {
    for(j=0;j<8;j++)
    {
      bmp2array_mapping__r(i, j, p_bmp_height, p_bmp_width, &col, &row);
      if(get_bit__r(*(p_bmp_data_buff+i), j)>0)
      {
        *(p_bit_array + row*p_bmp_width + col)=1;
      }
    }
  }
}

void map_bit_array_to_lcd_stream__r( char *p_bit_array,
                                     unsigned char *p_lcd_stream,
                                     uint32_t p_bmp_width,
                                     uint32_t p_bmp_height )
{
  int i, j, col, row;
  
#if TST_PRINT
  printf("==> map_bit_array_to_lcd_stream__r\n");
#endif    
  
  for(row=0; row<p_bmp_height; row++)
  {
    for(col=0;col<p_bmp_width;col++)
    {
      array2lcd_mapping__r(row, col, p_bmp_width, &i, &j);
      if(*(p_bit_array + row*p_bmp_width + col) > 0)
      {
        set_bit__r((p_lcd_stream+i), j);
#if TST_PRINT
        printf("*");
#endif
      }
      else
      {
#if TST_PRINT
        printf(" ");
#endif
      }			
    }
#if TST_PRINT
    printf("\n");
#endif
  }  
}

int write_lcd_stream_to_file__r( unsigned char *p_lcd_stream,
                                 uint32_t p_lcd_stream_len,
                                 const char *p_file_name )
{
  FILE *ptr_file = NULL;
  int i;

#if TST_PRINT
  printf("==> write_lcd_stream_to_file__r\n");
#endif    
  
  ptr_file = fopen(p_file_name, "wt");
  if( ptr_file == NULL )
  {
    printf("/*** Fail to create LCD stream file %s! ***/\n", p_file_name);
    return UNSUCCESS_EC;
  }
  
  for(i=0; i<p_lcd_stream_len;i++)
  {
    fprintf(ptr_file, "0x%02X,", *(p_lcd_stream+i));
    
    if(i%16 == 15)
      fprintf(ptr_file, "\n");   
  }
  
  fclose(ptr_file);
  
  return SUCCESS_EC;
}

int convert_bmp_to_lcd__r( const char *p_file_name )
{
  int ret_val = SUCCESS_EC;
  char *ptr_bmp_data_buff = NULL;
  char *ptr_bit_array = NULL;
  unsigned char *ptr_lcd_stream = NULL;
  uint32_t bmp_data_size, bmp_width, bmp_height;
  
#if TST_PRINT
  printf("==> converst bmp to lcd from %s\n", p_file_name);
#endif
  
  ret_val = read_bmp_file_to_buffer__r( p_file_name,
                                        &ptr_bmp_data_buff,
                                        &bmp_data_size,
                                        &bmp_width,
                                        &bmp_height );
  if( ret_val != SUCCESS_EC )
  {
    return ret_val;
  }
  
  ptr_bit_array = (char *)malloc(bmp_width*bmp_height);
  if( ptr_bit_array == NULL )
  {
    printf("/*** Fail to allocate memery for bit array! ***/\n");
    free(ptr_bmp_data_buff);
    return UNSUCCESS_EC;
  }
  memset(ptr_bit_array, 0, bmp_width*bmp_height);
  
  map_bmp_to_bit_array__r( ptr_bmp_data_buff, 
                           ptr_bit_array,
                           bmp_data_size,
                           bmp_width,
                           bmp_height );  
  free(ptr_bmp_data_buff);
  
  ptr_lcd_stream = (unsigned char *)malloc(bmp_width*bmp_height/8);
  if( ptr_lcd_stream == NULL )
  {
    printf("/*** Fail to allocate memery for LCD steam! ***/\n");
    free(ptr_bit_array);
    return UNSUCCESS_EC;
  }
  memset( ptr_lcd_stream, 0, bmp_width*bmp_height/8 );
  
  map_bit_array_to_lcd_stream__r( ptr_bit_array,
                                  ptr_lcd_stream,
                                  bmp_width,
                                  bmp_height );                                                                   
  free(ptr_bit_array);  
  
  write_lcd_stream_to_file__r( ptr_lcd_stream, bmp_width*bmp_height/8, "output.txt" );
  free(ptr_lcd_stream);
  
  return SUCCESS_EC;
}

int read_lcd_stream_to_buffer__r( const char *p_file_name,
                                  uint32_t p_height,
                                  uint32_t p_width,
                                  unsigned char **p_lcd_buff )
{
  int  ret_val = SUCCESS_EC;
  FILE *ptr_file = NULL;
  long file_size;
  char *file_buff = NULL;
  char *ptr_read_hdr = NULL;
  char *ptr_read_tear = NULL;
  unsigned char *ptr_write = NULL; 
  int  lcd_buff_idx; 
  
#if TST_PRINT
  printf("==> read_lcd_stream_to_buffer__r\n");
#endif
  
  ptr_file = fopen(p_file_name, "rt");
  if(NULL==ptr_file)
  {
    printf("/*** Fail to open file %s! ***/\n", p_file_name);
    return UNSUCCESS_EC;
  }
  
  fseek (ptr_file , 0 , SEEK_END);
  file_size = ftell (ptr_file);
  rewind (ptr_file);
  
  file_buff = (char *)malloc(file_size);
  if( file_buff == NULL )
  {
    printf("/*** Fail to allocate memery for LCD stream file! ***/\n");
    fclose(ptr_file);
    return UNSUCCESS_EC;
  }
  
  fread(file_buff, 1, file_size, ptr_file);
  fclose(ptr_file);
  
  *p_lcd_buff = (char *)malloc(p_height*p_width/8);
  if( *p_lcd_buff == NULL )
  {
    printf("/*** Fail to allocate memery for LCD stream buffer! ***/\n");
    free(file_buff);
    return UNSUCCESS_EC;
  }
  
  ptr_read_hdr = file_buff;
  ptr_write = *p_lcd_buff;
  
  for( lcd_buff_idx=0; lcd_buff_idx<p_height*p_width/8; lcd_buff_idx++ )
  {
    if(ptr_read_hdr - file_buff >= file_size )
    {
      printf("/*** Not enough LCD stream for BMP file! ***/\n");
      free(file_buff);
      free(*p_lcd_buff);
      return UNSUCCESS_EC;
    }
    
    for( ptr_read_tear=ptr_read_hdr; ptr_read_tear<(file_buff+file_size); ptr_read_tear++ )
    {
      
    }
    
  }
  
}

int convert_lcd_to_bmp__r( const char *p_file_name, 
                           uint32_t p_height,
                           uint32_t p_width )
{
  int  ret_val = SUCCESS_EC;
  
#if TST_PRINT
  printf("==> convert_lcd_to_bmp__r\n");
  printf("    p_file_name: %s\n", p_file_name);
  printf("    p_height:    %d\n", p_height);
  printf("    p_width:     %d\n", p_width);
#endif
  
  
  
  return SUCCESS_EC;
}

main(int argc, char *argv[])
{
  char *ptr = NULL;
  int  argv_len, tmp_len;
  uint32_t height, width;
  int  ret_val = SUCCESS_EC;
  
  if(2==argc && strcmp(argv[1],"b2l")==0 )
  {
    ret_val = convert_bmp_to_lcd__r("input.bmp");
  }
  else if(3==argc && strcmp(argv[1],"b2l")==0 )
  {
    argv_len = strlen(argv[2]);
    tmp_len = strlen(".bmp");
    if( (argv_len > tmp_len) && (strcmp(argv[2]+argv_len-tmp_len, ".bmp")==0) )
    {
      ret_val = convert_bmp_to_lcd__r(argv[2]);
    }
    else
    {
      printf("/*** Illegal file name: %s ***/\n", argv[2]);
      print_guide__r();
      return;
    }    
  }
  else if( (argc>=4 && argc<=5) && strcmp(argv[1], "l2b")==0 )
  {
    for( ptr=argv[2]; *ptr!='\0'; ptr++ )
    {
      if( *ptr<'0' || *ptr>'9' )
      {
        printf("/*** Illegal height value! ***/\n");
        print_guide__r();
        return;
      }
    }
    height = atoi(argv[2]);
    if( height%8 != 0 )
    {
      printf("/*** The height given is not 8N: %d! ***/\n", height);
      print_guide__r();
      return;
    }
    
    for( ptr=argv[3]; *ptr!='\0'; ptr++ )
    {
      if( *ptr<'0' || *ptr>'9' )
      {
        printf("/*** Illegal width value! ***/\n");
        print_guide__r();
        return;
      }
    }
    width = atoi(argv[3]);
    if( width%8 != 0 )
    {
      printf("/*** The width given is not 8N: %d! ***/\n", width);
      print_guide__r();
      return;
    }
    
    if( argc == 4 )
    {
      ret_val = convert_lcd_to_bmp__r("input.txt", height, width);
    }
    else
    {
      argv_len = strlen(argv[4]);
      tmp_len = strlen(".txt");
      if( (argv_len > tmp_len) && (strcmp(argv[4]+argv_len-tmp_len, ".txt")==0) )
      {
        ret_val = convert_lcd_to_bmp__r(argv[4], height, width);
      }
      else
      {
        printf("/*** Illegal file name: %s ***/\n", argv[4]);
        print_guide__r();
        return;
      }
    }    
  }
  else
  {
    print_guide__r();    
  }    
}

#if 0
main()
{
	int i,j;
	int row, col;
	//int page,bit_idx,byte_idx;
#if LCD_TO_BMP >1
    unsigned char *p = modified_logo;
#else	
	unsigned char *p = logo;
#endif
	unsigned char bit_array[64][128];
	unsigned char bmp_content_buff[1024];	
	FILE *p_file = NULL;
	unsigned char magic_num[2] = {'B', 'M'};
	char *bmp_buff = NULL;
	int bmp_buff_size = 0;
	bmpfile_header__t *p_bmpfile_hd = NULL;
	bitmap_info_header__t *p_bf_info_hd = NULL;
	uint32_t *p_padding = NULL;
	
	
	memset(bit_array, 0, sizeof(bit_array));
	memset(bmp_content_buff, 0, sizeof(bmp_content_buff));
	
	for( i=0; i<sizeof(logo); i++ )
	{
		for(j=0;j<8;j++)
		{
			lcd2array_mapping__r(i, j, 128, &col, &row);
			if(get_bit__r(*(p+i), j)>0)
				bit_array[row][col] = 1;
		}
	}
	
	for(row=0; row<64; row++)
	{
		for(col=0;col<128;col++)
		{			
			array2bmp_mapping__r(col, row, 64, 128, &i, &j);
			if(bit_array[row][col]>0)
			{
				set_bit__r(&bmp_content_buff[i], j);
#if TST_PRINT
				printf("*");
#endif
			}
			else
			{
#if TST_PRINT
				printf(" ");
#endif
			}			
		}
#if TST_PRINT
		printf("\n");
#endif
	}
	
	bmp_buff = (char *)malloc(sizeof(bmpfile_magic__t));
	if(NULL==bmp_buff)
	{
		printf("allocate buffer failed: bmpfile_magic__t\n");
		return;
	}
	bmp_buff_size += sizeof(bmpfile_magic__t);
	*bmp_buff = 'B';
	*(bmp_buff+1) = 'M';
	
	bmp_buff = (char *)realloc(bmp_buff, bmp_buff_size+sizeof(bmpfile_header__t));
	if(NULL==bmp_buff)
	{
		printf("allocate buffer failed: bmpfile_header__t\n");
		return;
	}
	p_bmpfile_hd = (bmpfile_header__t *)(bmp_buff+bmp_buff_size);
	bmp_buff_size += sizeof(bmpfile_header__t);
	memset(p_bmpfile_hd, 0, sizeof(bmpfile_header__t));
	/*
    uint32_t filesz;
    uint16_t creator1;
    uint16_t creator2;
    uint32_t bmp_offset;	
    */
	
	bmp_buff = (char *)realloc(bmp_buff, bmp_buff_size+sizeof(bitmap_info_header__t));
	if(NULL==bmp_buff)
	{
		printf("allocate buffer failed: bitmap_info_header__t\n");
		return;
	}
	p_bf_info_hd = (bitmap_info_header__t *)(bmp_buff+bmp_buff_size);
	bmp_buff_size += sizeof(bitmap_info_header__t);
	memset(p_bf_info_hd, 0, sizeof(bitmap_info_header__t));
    p_bf_info_hd->header_sz = 40;
    p_bf_info_hd->width = 128;
    p_bf_info_hd->height = 64;
    p_bf_info_hd->nplanes = 1;
    p_bf_info_hd->bitspp = 1;
    p_bf_info_hd->compress_type = 0;
    p_bf_info_hd->bmp_bytesz = (p_bf_info_hd->width)*(p_bf_info_hd->height)/8;
    /*
    int32_t hres;
    int32_t vres;
    uint32_t ncolors;
    uint32_t nimpcolors;	
    */
    
    bmp_buff = (char *)realloc(bmp_buff, bmp_buff_size+2*sizeof(uint32_t));
	if(NULL==bmp_buff)
	{
		printf("allocate buffer failed: uint32_t\n");
		return;
	}
	p_padding = (uint32_t *)(bmp_buff+bmp_buff_size);
	bmp_buff_size += 2*sizeof(uint32_t);
	*p_padding = 0;
	*(p_padding+1) = 0xFFFFFF;
    
    p_bmpfile_hd->filesz = p_bf_info_hd->bmp_bytesz + bmp_buff_size;
    p_bmpfile_hd->bmp_offset = bmp_buff_size;
	
	p_file = fopen("output.bmp", "wb");
	if(NULL==p_file)
	{
		printf("open file failed!\n");
		return;
	}
	
	fwrite(bmp_buff, 1, bmp_buff_size, p_file);
	fwrite(bmp_content_buff, 1, sizeof(bmp_content_buff), p_file);
	
	fclose(p_file);
	
	free(bmp_buff);
	/*
	for(i=0;i<64;i++)
	{
		page = (int)(i/8);
		bit_idx = i%8;
		for(j=0;j<128;j++)
		{
			byte_idx = page*128 + j;
			if( get_bit__r(*(logo+byte_idx), 7-bit_idx)>0)
				printf("*");
			else
				printf(" ");
		}
		printf("\n");
	}
	*/
}


main()
{
	FILE *p_file = NULL;
	long file_size;
	unsigned char *bmp_file_buff = NULL;
	unsigned char *bmp_buff = NULL;
	bmpfile_header__t *p_bmpfile_hd = NULL;
	int i, j;
	int col, row;
	unsigned char bit_array[64][128];
	unsigned char lcd_buff[1024];
	
	memset(lcd_buff, 0, sizeof(lcd_buff));
	memset(bit_array, 0, sizeof(bit_array));
	p_file = fopen("input.bmp", "rb");
	if(NULL==p_file)
	{
		printf("open file failed!\n");
		return;
	}
	
	fseek (p_file , 0 , SEEK_END);
	file_size = ftell (p_file);
	rewind (p_file);
	
	bmp_file_buff = (char *)malloc(file_size);
	if(bmp_file_buff == NULL)
	{
		printf("allocate buffer failed\n");
		return;
	}
	
	fread(bmp_file_buff, 1, file_size, p_file);
	fclose(p_file);
	
	p_bmpfile_hd = (bmpfile_header__t *)(bmp_file_buff + sizeof(bmpfile_magic__t));
	bmp_buff = bmp_file_buff + p_bmpfile_hd->bmp_offset;
	
	for(i=0; i<(p_bmpfile_hd->filesz - p_bmpfile_hd->bmp_offset); i++)
	{
		for(j=0;j<8;j++)
		{
			bmp2array_mapping__r(i, j, 64, 128, &col, &row);
			if(get_bit__r(*(bmp_buff+i), j)>0)
			{
				bit_array[row][col]=1;
			}			
		}
	}
	
	free(bmp_file_buff);
	
	for(row=0; row<64; row++)
	{
		for(col=0;col<128;col++)
		{			
			array2lcd_mapping__r(row, col, 128, &i, &j);
			if(bit_array[row][col]>0)
			{
				set_bit__r(&lcd_buff[i], j);
#if TST_PRINT
				printf("*");
#endif
			}
			else
			{
#if TST_PRINT
				printf(" ");
#endif
			}			
		}
#if TST_PRINT
		printf("\n");
#endif
	}
	
	p_file = fopen("output.txt", "wt");
	if( p_file == NULL )
	{
		printf("open file output.txt failed\n");
		return;
	}
	
	for(i=0; i<sizeof(lcd_buff);i++)
	{
		if(i%16 == 0)
			fprintf(p_file, "\n");
		fprintf(p_file, "0x%02X,", lcd_buff[i]);
	}
	
	fclose(p_file);
}


#endif
